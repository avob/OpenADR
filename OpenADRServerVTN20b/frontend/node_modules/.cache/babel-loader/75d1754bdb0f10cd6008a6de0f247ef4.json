{"ast":null,"code":"import _classCallCheck from \"/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/src/components/containers/EventPage.js\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport * as vtnConfigurationActions from '../../actions/vtnConfigurationActions';\nimport * as eventActions from '../../actions/eventActions';\nimport * as venActions from '../../actions/venActions';\nimport { withStyles } from '@material-ui/core/styles';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport Typography from '@material-ui/core/Typography';\nimport Divider from '@material-ui/core/Divider';\nimport EventList from '../Event/EventList';\nimport EventCalendar from '../Event/EventCalendar';\nimport { history } from '../../store/configureStore';\nimport moment from 'moment';\n\nfunction TabContainer(props) {\n  return React.createElement(Typography, {\n    component: \"div\",\n    style: {\n      padding: 8 * 3\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29\n    },\n    __self: this\n  }, props.children);\n}\n\nvar styles = function styles(theme) {\n  return {\n    root: {\n      flexGrow: 1\n    },\n    container: {\n      display: 'flex',\n      flexWrap: 'wrap'\n    },\n    textField: {\n      marginLeft: theme.spacing.unit,\n      marginRight: theme.spacing.unit\n    },\n    dense: {\n      marginTop: 19\n    },\n    menu: {\n      width: 200\n    },\n    formControl: {\n      margin: theme.spacing.unit,\n      minWidth: 500\n    },\n    card: {\n      maxWidth: 350,\n      minWidth: 350\n    },\n    media: {\n      height: 40,\n      paddingTop: 10,\n      paddingRight: 10\n    },\n    button: {\n      margin: theme.spacing.unit\n    },\n    iconButton: {\n      marginTop: 10\n    }\n  };\n};\n\nexport var EventPage =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(EventPage, _React$Component);\n\n  function EventPage(props) {\n    var _this;\n\n    _classCallCheck(this, EventPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(EventPage).call(this, props));\n\n    _this.handleChange = function (event, value) {\n      _this.setState({\n        value: value\n      });\n\n      switch (value) {\n        case 0:\n          history.push(\"/event/list\");\n          break;\n\n        case 1:\n          history.push(\"/event/calendar\");\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    _this.refreshEvent = function () {\n      _this.props.eventActions.searchEvent(_this.state.filters, _this.state.start, _this.state.end, _this.state.pagination.page, _this.state.pagination.size);\n    };\n\n    _this.onFilterChange = function (filters) {\n      _this.setState({\n        filters: filters\n      });\n\n      _this.refreshEvent();\n    };\n\n    _this.onPaginationChange = function (pagination) {\n      _this.setState({\n        pagination: pagination\n      });\n\n      _this.refreshEvent();\n    };\n\n    _this.onVenSuggestionsFetchRequested = function (e) {\n      var filters = _this.state.filters.splice(0);\n\n      filters.push({\n        type: \"VEN\",\n        value: e.value\n      });\n\n      _this.props.venActions.searchVen(filters, 0, 5);\n    };\n\n    _this.onVenSuggestionsClearRequested = function () {};\n\n    _this.onVenSuggestionsSelect = function (ven) {\n      var filters = _this.state.filters;\n      filters.push({\n        type: \"VEN\",\n        value: ven.username\n      });\n\n      _this.setState({\n        filters: filters\n      });\n\n      _this.refreshEvent();\n    };\n\n    _this.onColorChange = function (color) {\n      _this.setState({\n        color: color\n      });\n    };\n\n    _this.onViewChange = function (view) {\n      _this.setState({\n        view: view\n      });\n\n      var range = _this.getRequestDateRange(_this.state.currentDate, view);\n\n      console.log(view);\n\n      _this.props.eventActions.searchEvent(_this.state.filters, range.start, range.end, _this.state.pagination.page, _this.state.pagination.size);\n    };\n\n    _this.getRequestDateRange = function (date, view) {\n      switch (view) {\n        case \"month\":\n        case \"week\":\n        case \"day\":\n          var d = moment(date);\n          return {\n            start: d.startOf(view).toDate().getTime(),\n            end: d.endOf(view).toDate().getTime()\n          };\n\n        case \"agenda\":\n          var d = moment(date).startOf(\"day\");\n          return {\n            start: d.toDate().getTime(),\n            end: d.add(2, \"week\").toDate().getTime()\n          };\n      }\n    };\n\n    _this.onCurrentDateChange = function (currentDate) {\n      _this.setState({\n        currentDate: currentDate\n      });\n\n      var range = _this.getRequestDateRange(currentDate, _this.state.view);\n\n      _this.props.eventActions.searchEvent(_this.state.filters, range.start, range.end, _this.state.pagination.page, _this.state.pagination.size);\n    };\n\n    _this.state = {};\n    _this.state.value = 0;\n    _this.state.filters = [];\n\n    if (props.location.state && props.location.state.filters.length > 0) {\n      _this.state.filters = _this.state.filters.concat(props.location.state.filters);\n    }\n\n    _this.state.pagination = {\n      page: 0,\n      size: 100\n    };\n    _this.state.color = \"status\";\n    _this.state.view = \"week\";\n    _this.state.currentDate = new Date();\n    return _this;\n  }\n\n  _createClass(EventPage, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.vtnConfigurationActions.loadMarketContext();\n      this.refreshEvent();\n\n      switch (this.props.match.params.panel) {\n        case \"list\":\n          this.setState({\n            value: 0\n          });\n          break;\n\n        case \"calendar\":\n          this.setState({\n            value: 1\n          });\n          break;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          classes = _this$props.classes,\n          event = _this$props.event;\n      var value = this.state.value;\n      return React.createElement(\"div\", {\n        className: classes.root,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(Tabs, {\n        value: this.state.value,\n        onChange: this.handleChange,\n        indicatorColor: \"primary\",\n        textColor: \"primary\",\n        centered: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, React.createElement(Tab, {\n        label: \"Events\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }), React.createElement(Tab, {\n        label: \"Calendar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      })), React.createElement(Divider, {\n        variant: \"middle\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }), value === 0 && React.createElement(TabContainer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, React.createElement(EventList, {\n        classes: classes,\n        marketContext: event.marketContext,\n        event: event.event,\n        deleteEvent: this.props.eventActions.deleteEvent,\n        filters: this.state.filters,\n        pagination: this.state.pagination,\n        onFilterChange: this.onFilterChange,\n        onPaginationChange: this.onPaginationChange,\n        ven: event.ven,\n        onVenSuggestionsFetchRequested: this.onVenSuggestionsFetchRequested,\n        onVenSuggestionsClearRequested: this.onVenSuggestionsClearRequested,\n        onVenSuggestionsSelect: this.onVenSuggestionsSelect,\n        color: this.state.color,\n        view: this.state.view,\n        currentDate: this.state.currentDate,\n        onColorChange: this.onColorChange,\n        onViewChange: this.onViewChange,\n        onCurrentDateChange: this.onCurrentDateChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      })), value === 1 && React.createElement(TabContainer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, React.createElement(EventCalendar, {\n        classes: classes,\n        marketContext: event.marketContext,\n        event: event.event,\n        deleteEvent: this.props.eventActions.deleteEvent,\n        filters: this.state.filters,\n        pagination: this.state.pagination,\n        onFilterChange: this.onFilterChange,\n        onPaginationChange: this.onPaginationChange,\n        ven: event.ven,\n        onVenSuggestionsFetchRequested: this.onVenSuggestionsFetchRequested,\n        onVenSuggestionsClearRequested: this.onVenSuggestionsClearRequested,\n        onVenSuggestionsSelect: this.onVenSuggestionsSelect,\n        color: this.state.color,\n        view: this.state.view,\n        currentDate: this.state.currentDate,\n        onColorChange: this.onColorChange,\n        onViewChange: this.onViewChange,\n        onCurrentDateChange: this.onCurrentDateChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return EventPage;\n}(React.Component);\nEventPage.propTypes = {\n  vtnConfigurationActions: PropTypes.object.isRequired,\n  eventActions: PropTypes.object.isRequired\n};\n\nfunction mapStateToProps(state) {\n  return {\n    event: state.event\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    vtnConfigurationActions: bindActionCreators(vtnConfigurationActions, dispatch),\n    eventActions: bindActionCreators(eventActions, dispatch),\n    venActions: bindActionCreators(venActions, dispatch)\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withStyles(styles)(EventPage));","map":{"version":3,"sources":["/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/src/components/containers/EventPage.js"],"names":["React","PropTypes","connect","bindActionCreators","vtnConfigurationActions","eventActions","venActions","withStyles","Tabs","Tab","Typography","Divider","EventList","EventCalendar","history","moment","TabContainer","props","padding","children","styles","theme","root","flexGrow","container","display","flexWrap","textField","marginLeft","spacing","unit","marginRight","dense","marginTop","menu","width","formControl","margin","minWidth","card","maxWidth","media","height","paddingTop","paddingRight","button","iconButton","EventPage","handleChange","event","value","setState","push","refreshEvent","searchEvent","state","filters","start","end","pagination","page","size","onFilterChange","onPaginationChange","onVenSuggestionsFetchRequested","e","splice","type","searchVen","onVenSuggestionsClearRequested","onVenSuggestionsSelect","ven","username","onColorChange","color","onViewChange","view","range","getRequestDateRange","currentDate","console","log","date","d","startOf","toDate","getTime","endOf","add","onCurrentDateChange","location","length","concat","Date","loadMarketContext","match","params","panel","classes","marketContext","deleteEvent","Component","propTypes","object","isRequired","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport * as vtnConfigurationActions from '../../actions/vtnConfigurationActions';\nimport * as eventActions from '../../actions/eventActions';\nimport * as venActions from '../../actions/venActions';\n\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport Typography from '@material-ui/core/Typography';\nimport Divider from '@material-ui/core/Divider';\n\nimport EventList from '../Event/EventList'\nimport EventCalendar from '../Event/EventCalendar'\n\nimport { history } from '../../store/configureStore';\n\nimport moment from 'moment'\n\n\n\n\nfunction TabContainer( props ) {\n  return (\n  <Typography component=\"div\" style={ { padding: 8 * 3 } }>\n    { props.children }\n  </Typography>\n  );\n}\n\nconst styles = theme => ({\n  root: {\n    flexGrow: 1,\n  },\n  container: {\n    display: 'flex',\n    flexWrap: 'wrap',\n  },\n  textField: {\n    marginLeft: theme.spacing.unit,\n    marginRight: theme.spacing.unit,\n  },\n  dense: {\n    marginTop: 19,\n  },\n  menu: {\n    width: 200,\n  },\n  formControl: {\n    margin: theme.spacing.unit,\n    minWidth: 500,\n  },\n  card: {\n    maxWidth: 350,\n    minWidth: 350,\n  },\n  media: {\n    height: 40,\n    paddingTop: 10,\n    paddingRight: 10\n  },\n  button: {\n    margin: theme.spacing.unit,\n  },\n  iconButton: {\n    marginTop: 10\n  },\n});\n\n\nexport class EventPage extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state= {};\n    this.state.value = 0;\n    this.state.filters =  [];\n    if(props.location.state && props.location.state.filters.length > 0) {\n      this.state.filters = this.state.filters.concat(props.location.state.filters)\n    }\n\n    this.state.pagination = {\n      page: 0\n      , size: 100\n    }\n\n    this.state.color = \"status\";\n    this.state.view = \"week\";\n    this.state.currentDate = new Date();\n  }\n\n  handleChange = (event, value) => {\n    this.setState( {\n      value\n    } );\n    switch(value) {\n      case 0:\n        history.push(\"/event/list\")\n        break;\n      case 1:\n        history.push(\"/event/calendar\")\n        break;\n      default:\n        break;\n    }\n  };\n\n  componentDidMount() {\n    this.props.vtnConfigurationActions.loadMarketContext();\n    this.refreshEvent();\n    switch(this.props.match.params.panel){\n      case \"list\":\n        this.setState({value:0});\n        break;\n      case \"calendar\":\n        this.setState({value:1});\n        break;\n    }\n  }\n\n  refreshEvent = () => {\n    this.props.eventActions.searchEvent(this.state.filters, this.state.start, this.state.end\n      , this.state.pagination.page, this.state.pagination.size);\n  }\n\n  onFilterChange = (filters) => {\n    this.setState({filters});\n    this.refreshEvent();\n  }\n\n  onPaginationChange = (pagination) => {\n    this.setState({pagination});\n    this.refreshEvent();\n  }\n\n  onVenSuggestionsFetchRequested = (e) => {\n    var filters = this.state.filters.splice(0);\n    filters.push({type:\"VEN\", value:e.value});\n    this.props.venActions.searchVen(filters, 0, 5);\n  }\n\n  onVenSuggestionsClearRequested = () => {\n  }\n\n  onVenSuggestionsSelect = (ven) => {\n     var filters = this.state.filters;\n    filters.push({type:\"VEN\", value:ven.username});\n    this.setState({filters});\n    this.refreshEvent();\n  }\n\n  onColorChange = (color) => {\n    this.setState({color});\n  }\n\n  onViewChange = (view) => {\n    this.setState({view});\n    var range = this.getRequestDateRange(this.state.currentDate, view)\n    console.log(view)\n    this.props.eventActions.searchEvent(this.state.filters, range.start, range.end\n      , this.state.pagination.page, this.state.pagination.size);\n  }\n\n  getRequestDateRange = (date, view) => {\n    switch(view) {\n      case \"month\":\n      case \"week\":\n      case \"day\":\n        var d = moment(date);\n        return {\n          start: d.startOf(view).toDate().getTime()\n          , end: d.endOf(view).toDate().getTime()\n        };\n      case \"agenda\":\n        var d = moment(date).startOf(\"day\");\n        return {\n          start: d.toDate().getTime()\n          , end: d.add(2, \"week\").toDate().getTime()\n        };\n    }\n  }\n\n  onCurrentDateChange = (currentDate) => {\n    this.setState({currentDate});\n\n    var range = this.getRequestDateRange(currentDate, this.state.view)\n    this.props.eventActions.searchEvent(this.state.filters, range.start, range.end\n      , this.state.pagination.page, this.state.pagination.size);\n  }\n\n  render() {\n    const {classes, event} = this.props;\n    const {value} = this.state;\n    return (\n     <div className={ classes.root }>\n      <Tabs value={ this.state.value }\n            onChange={ this.handleChange }\n            indicatorColor=\"primary\"\n            textColor=\"primary\"\n            centered>\n        <Tab label=\"Events\" />\n        <Tab label=\"Calendar\" />\n      </Tabs>\n      <Divider variant=\"middle\" />\n\n      { value === 0 && <TabContainer>\n                          <EventList classes={classes} \n                          marketContext={ event.marketContext }\n                          event={event.event}\n                          \n                          deleteEvent={ this.props.eventActions.deleteEvent}\n                          filters={this.state.filters}\n                          pagination={this.state.pagination}\n                          onFilterChange={this.onFilterChange}\n                          onPaginationChange={this.onPaginationChange}\n\n                          ven={event.ven}\n                          onVenSuggestionsFetchRequested={this.onVenSuggestionsFetchRequested}\n                          onVenSuggestionsClearRequested={this.onVenSuggestionsClearRequested}\n                          onVenSuggestionsSelect={this.onVenSuggestionsSelect}\n\n                          color={this.state.color}\n                          view={this.state.view}\n                          currentDate={this.state.currentDate}\n                          onColorChange={this.onColorChange}\n                          onViewChange={this.onViewChange}\n                          onCurrentDateChange={this.onCurrentDateChange}\n                           />\n                       </TabContainer> }\n                       \n      { value === 1 && <TabContainer>\n                          <EventCalendar classes={classes} \n                          marketContext={ event.marketContext }\n                          event={event.event}\n                          deleteEvent={ this.props.eventActions.deleteEvent}\n\n                          filters={this.state.filters}\n                          pagination={this.state.pagination}\n                          onFilterChange={this.onFilterChange}\n                          onPaginationChange={this.onPaginationChange}\n\n                          ven={event.ven}\n                          onVenSuggestionsFetchRequested={this.onVenSuggestionsFetchRequested}\n                          onVenSuggestionsClearRequested={this.onVenSuggestionsClearRequested}\n                          onVenSuggestionsSelect={this.onVenSuggestionsSelect}\n\n                          color={this.state.color}\n                          view={this.state.view}\n                          currentDate={this.state.currentDate}\n                          onColorChange={this.onColorChange}\n                          onViewChange={this.onViewChange}\n                          onCurrentDateChange={this.onCurrentDateChange}\n                 />\n                       </TabContainer> }\n\n    </div>\n\n    );\n  }\n}\n\nEventPage.propTypes = {\n  vtnConfigurationActions: PropTypes.object.isRequired,\n  eventActions: PropTypes.object.isRequired,\n};\n\nfunction mapStateToProps( state ) {\n  return {\n    event: state.event\n  };\n}\n\nfunction mapDispatchToProps( dispatch ) {\n  return {\n    vtnConfigurationActions: bindActionCreators( vtnConfigurationActions, dispatch ),\n    eventActions: bindActionCreators( eventActions, dispatch ),\n    venActions: bindActionCreators( venActions, dispatch )\n\n    \n\n\n  };\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)( withStyles( styles )( EventPage ) );\n"]},"metadata":{},"sourceType":"module"}