{"ast":null,"code":"import _classCallCheck from \"/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/src/components/AccountCreate/AccountUserCreate.js\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepLabel from '@material-ui/core/StepLabel';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport Paper from '@material-ui/core/Paper';\nimport AccountUserCreateIdentificationStep from './AccountUserCreateIdentificationStep';\nimport UserCreateAuthenticationFormPanel from '../common/UserCreateAuthenticationFormPanel';\nimport AccountCreateRoleStep from './AccountCreateRoleStep';\nimport UserCreateConfirmationFormPanel from '../common/UserCreateConfirmationFormPanel';\nvar defaultAuthenticationType = 'x509';\nvar authenticationTypes = {\n  x509: {\n    label: 'Client certificate authentication'\n  },\n  login: {\n    label: 'Login / Password authentication'\n  }\n};\n\nfunction getSteps() {\n  return ['Identification settings', 'Authentication settings', 'Roles settings', 'Confirmation'];\n}\n\nexport var AccountUserCreate =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AccountUserCreate, _React$Component);\n\n  function AccountUserCreate(props) {\n    var _this;\n\n    _classCallCheck(this, AccountUserCreate);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AccountUserCreate).call(this, props));\n\n    _this.handleCreateUser = function () {\n      var _this$state = _this.state,\n          identification = _this$state.identification,\n          authentication = _this$state.authentication,\n          roles = _this$state.roles;\n      var dto = {\n        'commonName': identification.venCommonName,\n        'needCertificateGeneration': identification.needCertificateGeneration,\n        'oadrProfil': identification.venOadrProfile,\n        'authenticationType': authentication.authenticationType,\n        'username': authentication.username,\n        'roles': roles\n      };\n\n      if (authentication.authenticationType == 'login') {\n        dto.password = authentication.authenticationPassword;\n      }\n\n      _this.props.createUser(dto);\n    };\n\n    _this.handleFinish = function () {\n      _this.handleCreateUser();\n    };\n\n    _this.handleNext = function () {\n      var activeStep = _this.state.activeStep;\n\n      if (activeStep === getSteps().length - 1) {\n        _this.handleFinish();\n      } else {\n        _this.setState({\n          activeStep: activeStep + 1\n        });\n      }\n    };\n\n    _this.handleBack = function () {\n      _this.setState(function (state) {\n        return {\n          activeStep: state.activeStep - 1\n        };\n      });\n    };\n\n    _this.handleReset = function () {\n      _this.setState({\n        activeStep: 0\n      });\n    };\n\n    _this.handleIndentificationStepChange = function (identification) {\n      _this.setState({\n        identification: identification\n      });\n    };\n\n    _this.handleAuthenticationStepChange = function (authentication) {\n      _this.setState({\n        authentication: authentication\n      });\n    };\n\n    _this.handleRoleStepChange = function (roles) {\n      _this.setState({\n        roles: roles\n      });\n    };\n\n    _this.state = {\n      activeStep: 0,\n      identification: {\n        commonName: \"\",\n        needCertificateGeneration: 'rsa'\n      },\n      authentication: {\n        username: '',\n        authenticationTypes: authenticationTypes,\n        authenticationType: defaultAuthenticationType,\n        authenticationPassword: '',\n        authenticationPasswordConfirm: ''\n      },\n      roles: []\n    };\n    return _this;\n  }\n\n  _createClass(AccountUserCreate, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          classes = _this$props.classes,\n          vtnConfiguration = _this$props.vtnConfiguration;\n      var steps = getSteps();\n      var activeStep = this.state.activeStep;\n      var that = this;\n\n      function getStepContent(step) {\n        switch (step) {\n          case 0:\n            return React.createElement(AccountUserCreateIdentificationStep, {\n              classes: classes,\n              identification: that.state.identification,\n              onChange: that.handleIndentificationStepChange,\n              vtnConfiguration: vtnConfiguration,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 128\n              },\n              __self: this\n            });\n\n          case 1:\n            return React.createElement(UserCreateAuthenticationFormPanel, {\n              classes: classes,\n              identification: that.state.identification,\n              authentication: that.state.authentication,\n              onChange: that.handleAuthenticationStepChange,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 133\n              },\n              __self: this\n            });\n\n          case 2:\n            return React.createElement(AccountCreateRoleStep, {\n              classes: classes,\n              roles: that.state.roles,\n              onChange: that.handleRoleStepChange,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 138\n              },\n              __self: this\n            });\n\n          case 3:\n            return React.createElement(UserCreateConfirmationFormPanel, {\n              classes: classes,\n              identification: that.state.identification,\n              authentication: that.state.authentication,\n              roles: that.state.roles,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 142\n              },\n              __self: this\n            });\n\n          default:\n            return 'Unknown step';\n        }\n      }\n\n      function getSetValidation(step) {\n        switch (step) {\n          case 0:\n            return true;\n\n          case 1:\n            return true;\n\n          case 2:\n            return true;\n\n          case 3:\n            return true;\n\n          default:\n            return false;\n        }\n      }\n\n      function handleValidatedNext(step) {\n        return function (e) {\n          if (getSetValidation(step)) {\n            if (that.state.hasError) {\n              that.setState({\n                hasError: false\n              });\n            }\n\n            that.handleNext(e);\n          } else {\n            that.setState({\n              hasError: true\n            });\n          }\n        };\n      }\n\n      return React.createElement(\"div\", {\n        className: classes.root,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(Stepper, {\n        activeStep: activeStep,\n        className: classes.stepper,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, steps.map(function (label, index) {\n        var props = {};\n        var labelProps = {};\n        props.completed = false;\n        return React.createElement(Step, Object.assign({\n          key: label\n        }, props, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 191\n          },\n          __self: this\n        }), React.createElement(StepLabel, Object.assign({}, labelProps, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 192\n          },\n          __self: this\n        }), label));\n      })), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, activeStep === steps.length ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        className: classes.instructions,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, \"All steps completed - you're finished\"), React.createElement(Button, {\n        onClick: this.handleReset,\n        className: classes.button,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, \"Reset\")) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }, React.createElement(Button, {\n        disabled: activeStep === 0,\n        onClick: this.handleBack,\n        className: classes.button,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, \"Back\"), React.createElement(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: handleValidatedNext(activeStep),\n        className: classes.button,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }, activeStep === steps.length - 1 ? 'Create User' : 'Next')), React.createElement(Typography, {\n        component: \"div\",\n        className: classes.instructions,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, React.createElement(Paper, {\n        elevation: 1,\n        style: {\n          padding: '20px 0px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, getStepContent(activeStep))))));\n    }\n  }]);\n\n  return AccountUserCreate;\n}(React.Component);\nexport default AccountUserCreate;","map":{"version":3,"sources":["/home/bzanni/Documents/github/OpenADR/OpenADRServerVTN20b/frontend/src/components/AccountCreate/AccountUserCreate.js"],"names":["React","PropTypes","withStyles","Stepper","Step","StepLabel","Button","Typography","Paper","AccountUserCreateIdentificationStep","UserCreateAuthenticationFormPanel","AccountCreateRoleStep","UserCreateConfirmationFormPanel","defaultAuthenticationType","authenticationTypes","x509","label","login","getSteps","AccountUserCreate","props","handleCreateUser","state","identification","authentication","roles","dto","venCommonName","needCertificateGeneration","venOadrProfile","authenticationType","username","password","authenticationPassword","createUser","handleFinish","handleNext","activeStep","length","setState","handleBack","handleReset","handleIndentificationStepChange","handleAuthenticationStepChange","handleRoleStepChange","commonName","authenticationPasswordConfirm","classes","vtnConfiguration","steps","that","getStepContent","step","getSetValidation","handleValidatedNext","e","hasError","root","stepper","map","index","labelProps","completed","instructions","button","padding","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\n\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepLabel from '@material-ui/core/StepLabel';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\n\n\nimport Paper from '@material-ui/core/Paper';\n\nimport AccountUserCreateIdentificationStep from './AccountUserCreateIdentificationStep'\nimport UserCreateAuthenticationFormPanel from '../common/UserCreateAuthenticationFormPanel'\nimport AccountCreateRoleStep from './AccountCreateRoleStep'\nimport UserCreateConfirmationFormPanel from '../common/UserCreateConfirmationFormPanel'\n\nconst defaultAuthenticationType = 'x509'\nconst authenticationTypes = {\n  x509: {\n    label: 'Client certificate authentication'\n  },\n  login: {\n    label: 'Login / Password authentication'\n  }\n}\n\nfunction getSteps() {\n  return [ 'Identification settings', 'Authentication settings', 'Roles settings', 'Confirmation' ];\n}\n\n\nexport class AccountUserCreate extends React.Component {\n  constructor( props ) {\n    super( props );\n    this.state = {\n      activeStep: 0,\n      identification: {\n        commonName: \"\",\n        needCertificateGeneration: 'rsa'\n      },\n      authentication: {\n          username: '',\n          authenticationTypes:authenticationTypes,\n          authenticationType: defaultAuthenticationType,\n          authenticationPassword: '',\n          authenticationPasswordConfirm: '',\n          \n      },\n      roles: []\n    };\n  }\n\n  handleCreateUser = () => {\n    const {identification, authentication, roles} = this.state;\n    var dto = {\n      'commonName': identification.venCommonName,\n      'needCertificateGeneration': identification.needCertificateGeneration,\n      'oadrProfil': identification.venOadrProfile,\n\n      'authenticationType': authentication.authenticationType,\n      'username': authentication.username,\n      'roles': roles\n    }\n\n    if ( authentication.authenticationType == 'login' ) {\n      dto.password = authentication.authenticationPassword\n    }\n\n    this.props.createUser( dto );\n  }\n\n\n  handleFinish = () => {\n    this.handleCreateUser();\n  }\n\n  handleNext = () => {\n    const {activeStep} = this.state;\n    if ( activeStep === getSteps().length - 1 ) {\n      this.handleFinish();\n    } else {\n      this.setState( {\n        activeStep: activeStep + 1,\n      } );\n    }\n\n  };\n\n  handleBack = () => {\n    this.setState( state => ({\n      activeStep: state.activeStep - 1,\n    }) );\n  };\n\n  handleReset = () => {\n    this.setState( {\n      activeStep: 0,\n    } );\n  };\n\n  \n  handleIndentificationStepChange = (identification) => {\n    this.setState({identification});\n  }\n\n  handleAuthenticationStepChange = (authentication) => {\n    this.setState({authentication});\n  } \n\n  handleRoleStepChange = (roles) => {\n    this.setState({roles});\n  }\n\n \n  render() {\n    const {classes, vtnConfiguration} = this.props;\n    const steps = getSteps();\n    const {activeStep} = this.state;\n    var that = this;\n\n\n    function getStepContent( step ) {\n      switch (step) {\n        case 0:\n          return <AccountUserCreateIdentificationStep classes={classes}\n            identification={that.state.identification}\n            onChange={that.handleIndentificationStepChange}\n            vtnConfiguration={vtnConfiguration}/>;\n        case 1:\n          return <UserCreateAuthenticationFormPanel classes={classes}\n            identification={that.state.identification}\n            authentication={that.state.authentication}\n            onChange={that.handleAuthenticationStepChange}/>;\n        case 2:\n          return <AccountCreateRoleStep classes={classes}\n            roles={that.state.roles}\n            onChange={that.handleRoleStepChange}/>;\n        case 3:\n          return <UserCreateConfirmationFormPanel classes={classes}\n            identification={that.state.identification}\n            authentication={that.state.authentication}\n            roles={that.state.roles}/>;\n        default:\n          return 'Unknown step';\n      }\n    }\n\n    function getSetValidation( step ) {\n      switch (step) {\n        case 0:\n          return true;\n        case 1:\n          return true;\n        case 2:\n          return true;\n        case 3:\n          return true;\n        default:\n          return false\n      }\n    }\n\n    function handleValidatedNext( step ) {\n      return (e) => {\n        if ( getSetValidation( step ) ) {\n          if ( that.state.hasError ) {\n            that.setState( {\n              hasError: false\n            } );\n          }\n          that.handleNext( e );\n        } else {\n          that.setState( {\n            hasError: true\n          } );\n        }\n      }\n    }\n\n    return (\n    <div className={ classes.root }>\n      <Stepper activeStep={ activeStep } className={ classes.stepper }>\n        { steps.map( (label, index) => {\n            const props = {};\n            const labelProps = {};\n            props.completed = false;\n            return (\n            <Step key={ label } {...props}>\n              <StepLabel {...labelProps}>\n                { label }\n              </StepLabel>\n            </Step>\n            );\n          } ) }\n      </Stepper>\n      <div>\n        { activeStep === steps.length ? (\n            <div>\n              <Typography className={ classes.instructions }>\n                All steps completed - you&apos;re finished\n              </Typography>\n              <Button onClick={ this.handleReset } className={ classes.button }>\n                Reset\n              </Button>\n            </div>\n            ) : (\n            <div>\n              <div>\n                <Button disabled={ activeStep === 0 }\n                        onClick={ this.handleBack }\n                        className={ classes.button }>\n                  Back\n                </Button>\n                <Button variant=\"contained\"\n                        color=\"primary\"\n                        onClick={ handleValidatedNext( activeStep ) }\n                        className={ classes.button }>\n                  { activeStep === steps.length - 1 ? 'Create User' : 'Next' }\n                </Button>\n              </div>\n              <Typography component=\"div\" className={ classes.instructions }>\n                <Paper elevation={ 1 } style={ { padding: '20px 0px' } }>\n                  { getStepContent( activeStep ) }\n                </Paper>\n              </Typography>\n              \n            </div>\n            ) }\n      </div>\n    </div>\n    );\n  }\n}\n\nexport default AccountUserCreate;\n"]},"metadata":{},"sourceType":"module"}